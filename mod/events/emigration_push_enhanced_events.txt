namespace = emigration_push_enhanced

# setup on_colony_yearly_pulse (intentionally delayed a year because automatic migration is disabled for brand-new colonies)
planet_event = {
	id = emigration_push_enhanced.1
	is_triggered_only = yes
	hide_window = yes
	pre_triggers = { has_owner = yes }
	trigger = { NOT = { has_deposit = d_emigration_push_enhanced } }
	immediate = { add_deposit = d_emigration_push_enhanced }
}

# cleanup on_colony_destroyed
planet_event = {
	id = emigration_push_enhanced.2
	is_triggered_only = yes
	hide_window = yes
	pre_triggers = { has_owner = yes }
	trigger = { has_deposit = d_emigration_push_enhanced }
	immediate = { remove_deposit = d_emigration_push_enhanced }
}

# test event to ensure every colony has the relevant modifier
event = {
	id = emigration_push_enhanced.3
	is_triggered_only = yes
	hide_window = yes
	immediate = {
		every_galaxy_planet = {
			limit = {
				is_colony = yes
				NOT = { has_deposit = d_emigration_push_enhanced }
			}
			add_deposit = d_emigration_push_enhanced
		}
	}
}